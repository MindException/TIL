# 포트(Port)

* IP주소를 타고 온 데이터가 마지막 종단점으로 프로세스에 들어가기 위한 목적지이다.  
* 개념적으로는 포트에 대해서 이해하고 있지만 평소에 궁금하였던 내용을 남겨본다.
<br>
<br>

## HTTP는 80번 포트, HTTPS는 443번 포트를 사용한다. 그러면 통신에 요청과 반응에서도 같은 포트를 사용할까?

* 먼저 정답을 얘기하면 아니다.  
* 대부분 우리가 기본적으로 생각하는 80과 443번 포트는 반응을 하는 웹서버가 사용하는 포트이다.  
* 사용자들이 서버에 요청을 보낼 때 사용하는 웹브라우저는 각자의 포트를 가지고 있다.
* __TMI)__ 크롬(웹브라우저)에서 새 탭을 눌러서 새창을 만든 후 서버에 접속할 때마다 새로운 포트가 생성되는 것을 알 수 있다.

## 80 포트는 한 개의 웹서버만 사용이 가능한가?  
* 정답은 거의 맞다. 한 포트에는 한 개의 프로세스만 사용하길 권장한다.
* 그렇다면 아마 한 개의 로컬환경에서 여러 개의 웹애플리케이션이 있을 경우 포트를 어떻게 해야하는지 궁금할 것이다. 이럴 때 사용하는 것이 가상 호스팅(Virtual Hosting)이다.
* 가상 호스팅은 HTTP 요청에서 "Host" 헤더를 기반으로 각각의 도메인 이름을 구별하여, 적절한 웹 사이트로 라우팅하는 기술이다.
* 예로 사용되는 프레임워크는 Apache 및 Nginx 등이 있다.

## Azure와 같은 클라우드 환경에서 외부에서 접속하려면 어떻게 해야하는가?  
1. 웹서버에서 사용할 port 정하기
2. 웹서버에서 외부접속 호스트 IP 모두 접근할 수 있게 오픈하기
3. OS에서 port 열어주기(linux 기준)  
    * 포트 열기(ex: 8123 포트)
    ```cmd
    firewall-cmd --permanent --zone=public --add-port=8123/tcp
    ```
    * 방화벽 다시 로드  
    ```cmd
    firewall-cmd --reload
    ```
    * 방화벽 설정이 변경된 것을 다시 알려야 하기 때문에 꼭 reload를 해야한다.
4. VM(Azure) - 설정 - 네트워킹 - 인바운드 포트 규칙에서 오픈할 포트를 추가하여 준다.